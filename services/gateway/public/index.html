<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Gateway Users</title>
</head>
<body>
  <h1>Users</h1>
  <p id="info"></p>
  <ul id="users"></ul>
  <p>Frontend SPA served separately on <a href="http://localhost:8080" target="_blank" rel="noreferrer">http://localhost:8080</a></p>
  <script>
    // Determine the base URL to use for API calls and navigation. When the
    // page is opened from the filesystem the origin starts with `file:` and
    // we need to explicitly target the running gateway service.
    const BASE_URL = window.location.origin.startsWith('file:')
      ? 'http://localhost:3000'
      : '';

    async function loadUsers() {
      const start = performance.now();
      const res = await fetch(`${BASE_URL}/users`);
      const { data, time } = await res.json();
      document.getElementById('info').textContent = `Fetched in ${time}ms (client ${Math.round(performance.now() - start)}ms)`;
      const list = document.getElementById('users');
      data.forEach(u => {
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = `${BASE_URL}/user.html?id=${u.id}`;
        a.textContent = u.name;
        li.appendChild(a);
        list.appendChild(li);
      });
    }
    loadUsers();
  </script>
</body>
</html>
